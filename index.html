<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Barcode Scanner</title>
    <script src="https://unpkg.com/@zxing/library@0.18.6/umd/index.min.js"></script>
</head>
<body>

<button id="start-button">Start Scanner</button>
<video id="video" style="display:none;"></video>
<div id="scanner-container"></div>

<h2 id="barcode-value" style="text-align:center;">Scanned Barcode Value: None</h2>

<script>
    let selectedDeviceId;
    const codeReader = new ZXing.BrowserMultiFormatReader();

    document.getElementById('start-button').addEventListener('click', function() {
        if (!selectedDeviceId) {
            // List video input devices
            codeReader.listVideoInputDevices()
                .then((videoInputDevices) => {
                    selectedDeviceId = videoInputDevices[0].deviceId;
                    startScan(selectedDeviceId);
                })
                .catch((err) => {
                    console.error(err);
                });
        } else {
            startScan(selectedDeviceId);
        }
    });

    function startScan(deviceId) {
        codeReader.decodeFromVideoDevice(deviceId, 'video', (result, err) => {
            if (result) {
                // Handle the scanned code as necessary
                document.getElementById('barcode-value').textContent = 'Scanned Barcode Value: ' + result.text;
                codeReader.reset(); // Resets the scanner
                document.getElementById('video').style.display = 'none'; // Hide the video element
            }
            if (err && !(err instanceof ZXing.NotFoundException)) {
                console.error(err);
                document.getElementById('barcode-value').textContent = 'Error: ' + err;
            }
        });
        document.getElementById('video').style.display = 'block'; // Show the video element
    }
</script>

</body>
</html>
